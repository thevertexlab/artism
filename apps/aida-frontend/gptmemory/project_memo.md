# AIDA项目备忘录 - LLM指南

！！NOTE 绝对不要删掉或者修改这一行：这是 project_memo.md ，是用来在大量修改中记录易错易混点防止丢失上下文反复导致相同 bug 或者忘记之前设计的，！！你需要少用列表换行多用信息非常紧凑的方式记录！！如果你执行了新操作，产生了经验，就紧凑的增加一行或者增加在过去相关行尾部！！，只记录我们调试过程中产生的必要信息不要空话套话general的。另外偶尔过去的 memo 有可能会出错，如果要挑战过去记录的经验，这时候问我要不要修正他们，告诉我从什么修改成什么让我决策，决策后同步修改 memo ！！！

- GPT Memory使用：!! 重要 !! 每次执行前后必须读和更新 project_memo.md !!；1)目录结构：project_memo.md(项目通用要点备忘录)、working_memory_[username].md(开发者工作记忆)；2)使用流程：初次使用AI助手时阅读memo文件→开始新任务时更新个人工作记忆（如果开发者显示引用了这个文件，否则不确定开发者是谁，可以不更新）→完成任务后记录进度→项目变更时更新context文件；3)最佳实践：保持文件简洁高密度、定期更新工作记忆、提交前确保符合规范、AI行为不一致时检查记忆文件。
- 前后端有重大更改时（新依赖，文件结构变更，重大功能变更等），都检查对应的 frontend/README.md 等对应模块根目录 README.md 和整个项目的 README.md ，另外检查 docs/zh/index.md 和相关目录看看有没有相关文档要更新，尤其是！！要求重构时，必须更新对应 docs/ 文档和 README ！！
- 环境变量在 env.example 和 .env （可能有），可以用 cat 命令查看（如果在 git 文件目录找不到）
- Docker容器化：1)已完成完整Docker容器化配置；2)文件结构：backend/Dockerfile(生产)、frontend/Dockerfile(生产)、docs/Dockerfile、docker-compose.yml(开发)、docker-compose.prod.yml(生产)、nginx/nginx.conf(反向代理)、scripts/mongo-init.js(数据库初始化)、docker-run.sh(一键启动脚本)、DOCKER_README.md(详细说明)；3)关键配置：Next.js需要output:'standalone'支持Docker、多阶段构建优化镜像大小、非root用户提升安全性、健康检查确保服务可用、数据持久化使用Docker卷；4)使用方式：开发模式docker-compose up、生产模式docker-compose -f docker-compose.prod.yml up -d、一键脚本./docker-run.sh自动处理环境变量和模式选择。
- 项目信息：AIDA(AI Artist Database)是艺术家社区平台；核心功能：1)艺术家数据库-存储艺术家信息；2)AI艺术家-基于LLM的虚拟艺术家；3)社区互动-用户交流平台。
- 技术架构：1)Monorepo结构：docs/(VitePress文档)、backend/(FastAPI后端)、frontend/(Next.js前端)、scraper/(数据采集)、gptmemory/(AI助手记忆)；2)数据流：爬虫采集→MongoDB存储→后端API→前端展示→LLM训练；3)技术栈：后端(FastAPI+SQLAlchemy+MongoDB+LangChain)、前端(Next.js+TypeScript+Tailwind CSS)、文档(VitePress双语)、爬虫(BeautifulSoup+Selenium)、AI(OpenAI API/自定义LLM)。
- 代码规范：1)Python：PEP 8、类型注解(Python 3.9+)、docstring、导入顺序(标准库>第三方库>本地模块)、snake_case变量函数、PascalCase类名；2)TypeScript：ESLint+Prettier、类型定义、camelCase函数变量、PascalCase组件、函数组件+React Hooks、避免直接操作DOM；3)CSS：**优先Tailwind CSS**、必要时使用Less、Mantine组件库通过Tailwind调整样式、全局样式globals.css、组件样式styles目录；4)文档：Markdown、中英同步、可运行代码示例、API文档参数说明。
- VitePress文档：1)侧边栏只显示二级标题(##)不显示三级标题(###)；2)解决方案：重要三级标题提升为二级，二级标题可以多一些，但是不超过10-15个左右、二级目录更详细、扁平化结构；3)目录规划：主要小节独立二级标题、正常使用三四级标题、保持结构清晰。
- Git工作流：1)分支命名：feature/short-description、fix/short-description、docs/short-description；2)提交格式：<emoji><type>(<scope>): <subject>，类型包括🚀feat/🔧fix/📚docs/💎style/🔨refactor/⚡perf/🧪test/🔧chore。
- 关键功能：1)艺术家数据库：基本信息、流派风格、代表作品、历史背景；2)AI艺术家：基于真实资料的AI人格、多轮对话、知识问答、虚拟互动；3)社区功能：个人主页、讨论论坛、作品分享、社交连接。
- 开发阶段：1)当前：基础架构搭建；2)下一步：核心功能开发；3)未来：AI模型训练、社区功能、多语言支持。
- Vercel部署404修复(更新配置)：1)创建frontend/app/not-found.tsx自定义404页面；2)创建frontend/app/[...not-found]/page.tsx作为catch-all路由捕获未匹配路径；3)移除next.config.js中的output:'standalone'配置避免与Vercel冲突；4)修正vercel.json为monorepo结构配置-根目录只保留schema，frontend/vercel.json保留framework设置；5)创建error.tsx和global-error.tsx提供完整错误处理；6)修复多个Mantine组件API变化(leftSection→children,gap→className,justify→className等)。重要：monorepo需要在Vercel Dashboard设置Root Directory为frontend，不要在根目录vercel.json用builds/routes配置。已推送到GitHub触发重新部署。
- Mantine v6 API兼容性修复(2024-06)：1)Grid.Col span属性从响应式对象改为数字；2)Group justify属性改为position属性(justify="space-between"→position="apart")；3)Button leftSection属性改为leftIcon；4)Badge和TextInput移除不支持的leftSection属性；5)SimpleGrid响应式配置改用breakpoints数组；6)Table组件改用标准HTML元素(thead/tbody/tr/td)；7)world-map页面修复SSR问题-动态导入Leaflet避免window undefined错误；8)修复文件：test/page.tsx、ai-artists/page.tsx、ArtistCard.tsx、ArtistFilter.tsx、ArtistPagination.tsx、ArtistGrid.tsx、ArtworkTable.tsx、world-map/page.tsx。所有TypeScript编译错误已解决。
- Next.js SSR clientModules错误修复(2024-12)：1)错误表现：TypeError Cannot read properties of undefined (reading 'clientModules')在预渲染阶段；2)根本原因：Providers.tsx中在React Context外部调用useTheme钩子导致SSR失败；3)解决方案：创建MantineWrapper组件确保useContext钩子在正确Provider内调用，简化服务端骨架结构避免复杂DOM；4)关键点：React钩子必须在对应Context.Provider内部调用，SSR时避免复杂嵌套结构防止clientModules相关错误。修复后Vercel部署成功。